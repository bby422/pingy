/*! pingy 2015-03-18 */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return b.call(a,c)}):b.call(a,$)}(this,function(a){function b(a){var c=this;return c instanceof b?void c.extend({_:{nodes:[],varNodeMap:{},watchMap:{},_8:{}},el:a}):new b(a)}function c(a,b,c){clearTimeout(a._._8[b]),h[b]=setTimeout(function(){h(a,b,c)},100)}function d(a,b){b=b||a.el.get(0),t(b.childNodes,function(b,c){switch(c.nodeType){case 1:e(a,c);break;case 3:f(a,c)}})}function e(b,c){var e=!0;t(c.attributes,function(d,f){var g,h=f.name,i=u(o(f.value)),j=1;if("y-each"==h)j=70,e=!1,g=m(b,c.innerHTML,i),r=[u(i)];else{if(w.test(h)){var n=i.split(":");return void a(c).on(h.split("y-on").join(""),function(a){b[n[0]](a,n.length>1?n[1]:null)})}"value"==h?(j=71,y.test(i)&&(g=k(b,i))):"y-show"==h?(j=72,g=l(b,i)):"y-html"==h?(j=73,g=l(b,i)):y.test(i)&&(g=k(b,i))}g&&(b._.nodes.push({type:j,node:c,fn:g,attr:h}),t(r,function(a,c){null==b._.varNodeMap[c]?b._.varNodeMap[c]=[b._.nodes.length-1]:b._.varNodeMap[c].push(b._.nodes.length-1)}))}),c.childNodes.length&&e&&d(b,c)}function f(a,b){var c,d=b.textContent;y.test(d)&&(c=k(a,o(d))),c&&(a._.nodes.push({type:3,node:b,fn:c}),t(r,function(b,c){null==a._.varNodeMap[c]?a._.varNodeMap[c]=[a._.nodes.length-1]:a._.varNodeMap[c].push(a._.nodes.length-1)}))}function g(a,b){function c(a){for(var b=0,c=a.length;c>b;b++)a[b]()}for(var d in a._.watchMap)null==b?c(a._.watchMap[d]):b==d?c(a._.watchMap[d]):0==b.indexOf(d+".")?c(a._.watchMap[d]):0==b.indexOf(d+"[")&&c(a._.watchMap[d])}function h(b,c,e){var f,h=b._.nodes;"string"==typeof c&&(h=[],f=c.split(","),t(f,function(a,c){for(var d in b._.varNodeMap){var e=u(c),f=u(d);e==f?i(b,h,b._.varNodeMap[d]):0==f.indexOf(e+".")&&i(b,h,b._.varNodeMap[d])}})),t(h,function(c,e){switch(e.type){case 1:e.node.setAttribute(e.attr,e.fn(b));break;case 3:e.node.textContent=e.fn(b);break;case 70:e.node.innerHTML=e.fn(b),d(b,e.node);break;case 71:a(e.node).val(e.fn(b));break;case 72:e.fn(b)?a(e.node).show():a(e.node).hide();break;case 73:e.node.innerHTML=e.fn(b)}}),"string"==typeof c?t(f,function(a,c){g(b,c)}):1==c&&g(b),e&&e()}function i(a,b,c){for(var d,e=0,f=c.length;f>e;e++)d=a._.nodes[c[e]],-1==b.indexOf(d)&&b.push(d)}function j(b){b.el.on("keyup change",function(c){var d,e=a(c.target),f=u(e.attr("name")),g=e.val();if(""!=f&&(!e.is("[type=radio]")||e.is(":checked"))){if(e.is("[type=checkbox]")){var g=[];b.el.find("[name="+f+"][type=checkbox]:checked").each(function(b,c){g.push(a(c).val())})}d=new Function("scope","val","scope."+f+"=val;"),d(b,g),b.render(f)}})}function k(a,b){r=[];var c,d="var __=[];with(scope){__.push('",e=b.replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(x,function(a,b){var c=o(b).match(v);return t(c,function(a,b){r.push(b)}),"');__.push("+n(b)+");__.push('"}),f="');} return __.join('')";return""==u(e)?null:c=new Function("scope",d+e+f)}function l(a,b){var c,d;return r=[],c=new Function("scope","with(scope){return "+b+";}"),d=o(b).match(v),t(d,function(a,b){r.push(b)}),c}function m(a,b,c){var d,e="var __=[];with(scope){_7("+c+",function($index,$value){__.push('",f=b.replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(x,function(a,b){return"');__.push("+n(b)+");__.push('"}),g="');})} return __.join('')";return""==u(f)?null:d=new Function("scope",e+f+g)}function n(a){return a.split("\\'").join("'").split("&quot;").join('"')}function o(a,b){return b=b||"",null==a?b:a}function p(b){b.el.find("[name]").each(function(){for(var c,d=a(this),e=d.attr("name").split("."),f=e.length,g=b,h=0;f>h;h++){if(c=e[h],h==f-1){c in g||(g[c]="");break}c in g||(g[c]={},g=g[c])}})}function q(c){var e,f=a(this);if(0!=f.size())return f.hide(),e=b(f),p(e),c&&c(e),d(e),e.render(!0,function(){f.show()}),j(e),f}var r,s=a.extend,t=a.each,u=a.trim,v=/[a-zA-Z$_][a-zA-Z0-9$_\.]*/g,w=/y-on[a-zA-Z0-9]+/,x=/\{\{([^\}]*)\}\}/g,y=/\{\{([^\}]*)\}\}/;return s(b.prototype,{render:function(a,b){var d=this;return c(d,a,b),d},extend:function(a){var b=this;return s(b,a),b},watch:function(a,b){if("object"==typeof a)for(key in a)this.watch(key,a[key]);var c=this._.watchMap;return a in c?c[a].push(b):c[a]=[b],this},_7:t}),a.fn.extend({pingy:q}),a});